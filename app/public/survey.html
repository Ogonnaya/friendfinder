<!DOCTYPE html>
<html>
  <head>
    <title>Friend Finder | Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Bootstrap & Stylesheet -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" type="text/css" href="/style.css" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Arizonia|Karla&display=swap"
      rel="stylesheet"
    />

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />
  </head>
  <body class="survey-background">
    <div class="container content">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item">
            <span><i class="fa fa-home"></i></span
            ><a href="/home">Friend Finder</a>
          </li>
          <!-- <li class="breadcrumb-item active" aria-current="page">Survey</li> -->
        </ol>
      </nav>
      <h1>Survey</h1>
      <p>
        Take a quick survey to find your new best friend! Choose if you strongly
        disagree, agree or are neutral about a statement.
      </p>

      <form>
        <div class="card">
          <div class="card-header">
            About You
          </div>
          <div class="card-body">
            <div class="form-group">
              <input
                id="name"
                type="text"
                class="form-control"
                placeholder="Name (Required)"
              />
            </div>
            <div class="form-group">
              <input
                id="photo"
                type="text"
                class="form-control"
                placeholder="Link to Profile Photo (Required)"
              />
            </div>
          </div>
        </div>
        <br />
        <div class="card">
          <div class="card-header">
            Questions
          </div>
          <div class="card-body">
            <ol>
              <div class="form-group">
                <li>
                  <label for="question1"
                    >You enjoy vibrant social events with lots of people.</label
                  >
                </li>
                <select class="form-control" id="question1">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question2"
                    >You often spend time exploring unrealistic yet intriguing
                    ideas.</label
                  >
                </li>
                <select class="form-control" id="question2">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question3"
                    >Your travel plans are more likely to look like a rough list
                    of ideas than a detailed itinerary.</label
                  >
                </li>
                <select class="form-control" id="question3">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question4"
                    >You often think about what you should have said in a
                    conversation long after it has taken place.</label
                  >
                </li>
                <select class="form-control" id="question4">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question5"
                    >If your friend is sad about something, your first instinct
                    is to support them emotionally, not try to solve their
                    problem.</label
                  >
                </li>
                <select class="form-control" id="question5">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question6">People can rarely upset you.</label>
                </li>
                <select class="form-control" id="question6">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question7"
                    >You often rely on other people to be the ones to start a
                    conversation and keep it going.</label
                  >
                </li>
                <select class="form-control" id="question7">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question8"
                    >You rarely worry if you made a good impression on someone
                    you met.</label
                  >
                </li>
                <select class="form-control" id="question8">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question9"
                    >It would be a challenge for you to spend the whole weekend
                    all by yourself without feeling bored.</label
                  >
                </li>
                <select class="form-control" id="question9">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
              <div class="form-group">
                <li>
                  <label for="question10"
                    >You are more of a detail-oriented than a big picture
                    person.</label
                  >
                </li>
                <select class="form-control" id="question10">
                  <option value="empty"></option>
                  <option value="1">Strongly disagree</option>
                  <option value="2">Disagree</option>
                  <option value="3">Neutral</option>
                  <option value="4">Agree</option>
                  <option value="5">Stongly Agree</option>
                </select>
              </div>
            </ol>
          </div>
        </div>
      </form>
      <div class="text-center">
        <button id="submitBtn" type="submit" class="btn btn-success btn-lg">
          Submit
        </button>
      </div>

      <!-- Modal after survey completion -->
      <div id="bestFriendModal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Your New Best Friend</h5>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-label="Close"
              >
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <h2 id="bestFriend"></h2>
              <img id="bestFriendPhoto" src="#" />
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-dismiss="modal"
              >
                Close
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer survey-ftr">
      <div class="container">
        <p>
          <a href="/api/friends">API Friends List</a> <span>|</span>
          <a target="_blank" href="https://github.com/Ogonnaya/friendfinder"
            >Github Repo</a
          >
        </p>
      </div>
    </footer>

    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>
  </body>
</html>

<script type="text/javascript">
  $("#submitBtn").on("click", function(event) {
    event.preventDefault();

    // Form validation
    var valid = true;

    if ($("#name").val() === "" || $("#photo").val() === "") {
      valid = false;
    } else if (
      $("#question1").val() === "empty" ||
      $("#question2").val() === "empty" ||
      $("#question3").val() === "empty" ||
      $("#question4").val() === "empty" ||
      $("#question5").val() === "empty" ||
      $("#question6").val() === "empty" ||
      $("#question7").val() === "empty" ||
      $("#question8").val() === "empty" ||
      $("#question9").val() === "empty" ||
      $("#question10").val() === "empty"
    ) {
      valid = false;
    }

    if (valid === true) {
      var newUser = {
        name: $("#name")
          .val()
          .trim(),
        photo: $("#photo")
          .val()
          .trim(),
        scores: [
          $("#question1").val(),
          $("#question2").val(),
          $("#question3").val(),
          $("#question4").val(),
          $("#question5").val(),
          $("#question6").val(),
          $("#question7").val(),
          $("#question8").val(),
          $("#question9").val(),
          $("#question10").val()
        ]
      };

      var currentURL = window.location.origin;

      // Ajax call for receiving response after POST req
      $.post(currentURL + "/api/friends", newUser, function(data) {
        $("#bestFriend").text(data.name);
        $("#bestFriendPhoto").attr("src", data.photo);
        $("#bestFriendModal").modal("toggle");
      });
    } else {
      // If a required field is missing, show alert
      alert("Survey is incomplete!");
    }
  });
</script>
